#pragma checksum "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "42d84cf93c0b3def7a9aca823ebe8f70e3bc1773"
// <auto-generated/>
#pragma warning disable 1591
namespace Oqtane.Modules.Admin.Files
{
    #line hidden
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#line 1 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using System;

#line default
#line hidden
#line 2 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using System.Linq;

#line default
#line hidden
#line 3 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using System.Collections.Generic;

#line default
#line hidden
#line 4 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#line 6 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#line 7 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#line 8 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#line 9 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#line 11 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Models;

#line default
#line hidden
#line 12 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Modules;

#line default
#line hidden
#line 13 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Modules.Controls;

#line default
#line hidden
#line 14 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Providers;

#line default
#line hidden
#line 15 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Security;

#line default
#line hidden
#line 16 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Services;

#line default
#line hidden
#line 17 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Shared;

#line default
#line hidden
#line 18 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Themes;

#line default
#line hidden
#line 19 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Themes.Controls;

#line default
#line hidden
#line 20 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.UI;

#line default
#line hidden
#line 21 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/_Imports.razor"
using Oqtane.Enums;

#line default
#line hidden
#line 2 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
using System.IO;

#line default
#line hidden
    public partial class Add : ModuleBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.OpenComponent<Oqtane.Modules.Controls.TabStrip>(0);
            __builder.AddAttribute(1, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder2) => {
                __builder2.AddMarkupContent(2, "\n    ");
                __builder2.OpenComponent<Oqtane.Modules.Controls.TabPanel>(3);
                __builder2.AddAttribute(4, "Name", "Upload");
                __builder2.AddAttribute(5, "Heading", "Upload Files");
                __builder2.AddAttribute(6, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.AddMarkupContent(7, "\n        ");
                    __builder3.OpenElement(8, "table");
                    __builder3.AddAttribute(9, "class", "table table-borderless");
                    __builder3.AddMarkupContent(10, "\n            ");
                    __builder3.OpenElement(11, "tr");
                    __builder3.AddMarkupContent(12, "\n                ");
                    __builder3.OpenElement(13, "td");
                    __builder3.AddMarkupContent(14, "\n                    ");
                    __builder3.OpenComponent<Oqtane.Modules.Controls.Label>(15);
                    __builder3.AddAttribute(16, "For", "upload");
                    __builder3.AddAttribute(17, "HelpText", "Upload the file you want");
                    __builder3.AddAttribute(18, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.AddContent(19, "Upload: ");
                    }
                    ));
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(20, "\n                ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(21, "\n                ");
                    __builder3.OpenElement(22, "td");
                    __builder3.AddMarkupContent(23, "\n                    ");
                    __builder3.OpenComponent<Oqtane.Modules.Controls.FileManager>(24);
                    __builder3.AddAttribute(25, "UploadMultiple", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#line 16 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                 true

#line default
#line hidden
                    ));
                    __builder3.AddAttribute(26, "ShowFiles", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Boolean>(
#line 16 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                                  false

#line default
#line hidden
                    ));
                    __builder3.AddAttribute(27, "FolderId", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Int32>(
#line 16 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                                                    _folderId

#line default
#line hidden
                    ));
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(28, "\n                ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(29, "\n            ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(30, "\n        ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(31, "\n        ");
                    __builder3.OpenComponent<Microsoft.AspNetCore.Components.Routing.NavLink>(32);
                    __builder3.AddAttribute(33, "class", "btn btn-secondary");
                    __builder3.AddAttribute(34, "href", 
#line 20 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                  NavigateUrl()

#line default
#line hidden
                    );
                    __builder3.AddAttribute(35, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.AddContent(36, "Cancel");
                    }
                    ));
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(37, "\n    ");
                }
                ));
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(38, "\n    ");
                __builder2.OpenComponent<Oqtane.Modules.Controls.TabPanel>(39);
                __builder2.AddAttribute(40, "Name", "Download");
                __builder2.AddAttribute(41, "Heading", "Download Files");
                __builder2.AddAttribute(42, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder3) => {
                    __builder3.AddMarkupContent(43, "\n");
#line 23 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
         if (_folders != null)
        {

#line default
#line hidden
                    __builder3.AddContent(44, "            ");
                    __builder3.OpenElement(45, "table");
                    __builder3.AddAttribute(46, "class", "table table-borderless");
                    __builder3.AddMarkupContent(47, "\n                ");
                    __builder3.OpenElement(48, "tr");
                    __builder3.AddMarkupContent(49, "\n                    ");
                    __builder3.OpenElement(50, "td");
                    __builder3.AddMarkupContent(51, "\n                        ");
                    __builder3.OpenComponent<Oqtane.Modules.Controls.Label>(52);
                    __builder3.AddAttribute(53, "For", "url");
                    __builder3.AddAttribute(54, "HelpText", "Enter the url of the file you wish to download");
                    __builder3.AddAttribute(55, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.AddContent(56, "Url: ");
                    }
                    ));
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(57, "\n                    ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(58, "\n                    ");
                    __builder3.OpenElement(59, "td");
                    __builder3.AddMarkupContent(60, "\n                        ");
                    __builder3.OpenElement(61, "input");
                    __builder3.AddAttribute(62, "id", "url");
                    __builder3.AddAttribute(63, "class", "form-control");
                    __builder3.AddAttribute(64, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#line 31 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                                     url

#line default
#line hidden
                    ));
                    __builder3.AddAttribute(65, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => url = __value, url));
                    __builder3.SetUpdatesAttributeName("value");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(66, "\n                    ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(67, "\n                ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(68, "\n                ");
                    __builder3.OpenElement(69, "tr");
                    __builder3.AddMarkupContent(70, "\n                    ");
                    __builder3.OpenElement(71, "td");
                    __builder3.AddMarkupContent(72, "\n                        ");
                    __builder3.OpenComponent<Oqtane.Modules.Controls.Label>(73);
                    __builder3.AddAttribute(74, "For", "folder");
                    __builder3.AddAttribute(75, "HelpText", "Select the folder to save the file in");
                    __builder3.AddAttribute(76, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.AddContent(77, "Folder: ");
                    }
                    ));
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(78, "\n                    ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(79, "\n                    ");
                    __builder3.OpenElement(80, "td");
                    __builder3.AddMarkupContent(81, "\n                        ");
                    __builder3.OpenElement(82, "select");
                    __builder3.AddAttribute(83, "id", "folder");
                    __builder3.AddAttribute(84, "class", "form-control");
                    __builder3.AddAttribute(85, "value", Microsoft.AspNetCore.Components.BindConverter.FormatValue(
#line 39 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                                         _folderId

#line default
#line hidden
                    ));
                    __builder3.AddAttribute(86, "onchange", Microsoft.AspNetCore.Components.EventCallback.Factory.CreateBinder(this, __value => _folderId = __value, _folderId));
                    __builder3.SetUpdatesAttributeName("value");
                    __builder3.AddMarkupContent(87, "\n                            ");
                    __builder3.OpenElement(88, "option");
                    __builder3.AddAttribute(89, "value", "-1");
                    __builder3.AddContent(90, "<Select Folder>");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(91, "\n");
#line 41 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                             foreach (Folder folder in _folders)
                            {

#line default
#line hidden
                    __builder3.AddContent(92, "                                ");
                    __builder3.OpenElement(93, "option");
                    __builder3.AddAttribute(94, "value", 
#line 43 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                 folder.FolderId

#line default
#line hidden
                    );
                    __builder3.AddContent(95, 
#line 43 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                                     new string('-', folder.Level * 2)

#line default
#line hidden
                    );
                    __builder3.AddContent(96, 
#line 43 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                                                                         folder.Name

#line default
#line hidden
                    );
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(97, "\n");
#line 44 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                            }

#line default
#line hidden
                    __builder3.AddContent(98, "                        ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(99, "\n                    ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(100, "\n                ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(101, "\n            ");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(102, "\n            ");
                    __builder3.OpenElement(103, "button");
                    __builder3.AddAttribute(104, "type", "button");
                    __builder3.AddAttribute(105, "class", "btn btn-success");
                    __builder3.AddAttribute(106, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#line 49 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                                    Download

#line default
#line hidden
                    ));
                    __builder3.AddContent(107, "Download");
                    __builder3.CloseElement();
                    __builder3.AddMarkupContent(108, "\n            ");
                    __builder3.OpenComponent<Microsoft.AspNetCore.Components.Routing.NavLink>(109);
                    __builder3.AddAttribute(110, "class", "btn btn-secondary");
                    __builder3.AddAttribute(111, "href", 
#line 50 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
                                                      NavigateUrl()

#line default
#line hidden
                    );
                    __builder3.AddAttribute(112, "ChildContent", (Microsoft.AspNetCore.Components.RenderFragment)((__builder4) => {
                        __builder4.AddContent(113, "Cancel");
                    }
                    ));
                    __builder3.CloseComponent();
                    __builder3.AddMarkupContent(114, "\n");
#line 51 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
        }

#line default
#line hidden
                    __builder3.AddContent(115, "    ");
                }
                ));
                __builder2.CloseComponent();
                __builder2.AddMarkupContent(116, "\n");
            }
            ));
            __builder.CloseComponent();
        }
        #pragma warning restore 1998
#line 55 "/Users/cam/Desktop/oqtane.framework/Oqtane.Client/Modules/Admin/Files/Add.razor"
       
    private string url = string.Empty;
    private List<Folder> _folders;
    private int _folderId = -1;

    public override SecurityAccessLevel SecurityAccessLevel => SecurityAccessLevel.Admin;

    protected override async Task OnInitializedAsync()
    {
        _folders = await FolderService.GetFoldersAsync(ModuleState.SiteId);

        if (PageState.QueryString.ContainsKey("id"))
        {
            _folderId = int.Parse(PageState.QueryString["id"]);
        }
    }

    private async Task Download()
    {
        if (url == string.Empty || _folderId == -1)
        {
            AddModuleMessage("You Must Enter A Url And Select A Folder", MessageType.Warning);
            return;
        }

        var filename = url.Substring(url.LastIndexOf("/", StringComparison.Ordinal) + 1);

        if (!Constants.UploadableFiles.Split(',')
                .Contains(Path.GetExtension(filename).ToLower().Replace(".", "")))
            {
                AddModuleMessage("File Could Not Be Downloaded From Url Due To Its File Extension", MessageType.Warning);
                return ;
            }

        if (!filename.IsPathOrFileValid())
        {
            AddModuleMessage("You Must Enter A Url With A Valid File Name", MessageType.Warning);
            return;
        }

        try
        {
            await FileService.UploadFileAsync(url, _folderId);
            await logger.LogInformation("File Downloaded Successfully From Url {Url}", url);
            AddModuleMessage("File Downloaded Successfully From Url", MessageType.Success);
        }
        catch (Exception ex)
        {
            await logger.LogError(ex, "Error Downloading File From Url {Url} {Error}", url, ex.Message);
            AddModuleMessage("Error Downloading File From Url. Please Verify That The Url Is Valid.", MessageType.Error);
        }
    }

#line default
#line hidden
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IFolderService FolderService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IFileService FileService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavigationManager { get; set; }
    }
}
#pragma warning restore 1591
